<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Marksheet Request Form - NIMS University</title>
<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  body { 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 2rem;
  }
  
  .container {
    max-width: 700px;
    margin: auto;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    overflow: hidden;
  }
  
  .header {
    background: linear-gradient(135deg, #2c3e50, #e74c3c);
    color: white;
    padding: 2rem;
    text-align: center;
  }
  
  .header h1 {
    font-size: 1.8rem;
    margin-bottom: 0.5rem;
  }
  
  .header p {
    opacity: 0.9;
    font-size: 0.9rem;
  }
  
  form { 
    padding: 2rem;
  }
  
  .form-group {
    margin-bottom: 1.5rem;
  }
  
  label { 
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #2c3e50;
    font-size: 0.9rem;
  }
  
  input, select, textarea { 
    width: 100%;
    padding: 0.8rem;
    border: 2px solid #e0e6ed;
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: #f8f9fa;
  }
  
  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #e74c3c;
    background: white;
    box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1);
  }
  
  select {
    cursor: pointer;
  }
  
  textarea {
    resize: vertical;
    min-height: 100px;
    font-family: inherit;
  }
  
  .checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 0.5rem;
  }
  
  .checkbox-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .checkbox-item input[type="checkbox"] {
    width: auto;
    margin: 0;
  }
  
  .urgency-selector {
    display: flex;
    gap: 1rem;
    margin-top: 0.5rem;
  }
  
  .urgency-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .urgency-item input[type="radio"] {
    width: auto;
    margin: 0;
  }
  
  .btn-container {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
  }
  
  button { 
    flex: 1;
    padding: 1rem 2rem;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .btn-primary {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    color: white;
  }
  
  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(231, 76, 60, 0.3);
  }
  
  .btn-secondary {
    background: #ecf0f1;
    color: #2c3e50;
  }
  
  .btn-secondary:hover {
    background: #d5dbdb;
  }
  
  .preview-container {
    display: none;
    margin-top: 2rem;
    padding: 1.5rem;
    background: #f8f9fa;
    border-radius: 10px;
    border-left: 4px solid #e74c3c;
  }
  
  .preview-title {
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 1rem;
  }
  
  .email-preview {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    white-space: pre-wrap;
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
    line-height: 1.5;
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #e0e6ed;
  }
  
  .info-box {
    background: #fff3cd;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    font-size: 0.85rem;
    color: #856404;
    border: 1px solid #ffeaa7;
  }
  
  .info-box strong {
    color: #6c5500;
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ðŸ“‹ Marksheet Request Form</h1>
      <p>Dynamic template generator for marksheet delay issues</p>
    </div>
    
    <form id="emailForm">
      <div class="info-box">
        <strong>ðŸ”„ Smart Template System:</strong> Each email is automatically customized with unique phrasing based on your specific situation and urgency level to prevent duplicate submissions.
      </div>
      
      <div class="form-group">
        <label>Full Name:</label>
        <input type="text" name="name" placeholder="Enter your full name" required>
      </div>
      
      <div class="form-group">
        <label>Course and Branch:</label>
        <input type="text" name="course" placeholder="e.g., B.Tech CSE, B.Tech AI/ML" required>
      </div>
      
      <div class="form-group">
        <label>Roll Number / Enrollment Number:</label>
        <input type="text" name="rollNumber" placeholder="Your roll/enrollment number" required>
      </div>
      
      <div class="form-group">
        <label>Batch Year:</label>
        <input type="text" name="batch" placeholder="e.g., 2021-2025" required>
      </div>
      
      <div class="form-group">
        <label>Phone Number:</label>
        <input type="tel" name="phone" placeholder="Your contact number" required>
      </div>
      
      <div class="form-group">
        <label>Your Email Address:</label>
        <input type="email" name="email" placeholder="your.email@example.com" required>
      </div>
      
      <div class="form-group">
        <label>Documents Needed:</label>
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="finalMarksheet" name="documents" value="final">
            <label for="finalMarksheet">Final Marksheet</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="consolidatedMarksheet" name="documents" value="consolidated">
            <label for="consolidatedMarksheet">Consolidated Marksheet</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="semesterResults" name="documents" value="semester">
            <label for="semesterResults">7th Semester Results (Debarred)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provisionalCert" name="documents" value="provisional">
            <label for="provisionalCert">Provisional Certificate</label>
          </div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Urgency Level:</label>
        <div class="urgency-selector">
          <div class="urgency-item">
            <input type="radio" id="standard" name="urgency" value="standard" checked>
            <label for="standard">Standard Request</label>
          </div>
          <div class="urgency-item">
            <input type="radio" id="urgent" name="urgency" value="urgent">
            <label for="urgent">Urgent (Job/Admission)</label>
          </div>
          <div class="urgency-item">
            <input type="radio" id="critical" name="urgency" value="critical">
            <label for="critical">Critical (Deadline Soon)</label>
          </div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Recipient:</label>
        <select name="recipient" required>
          <option value="">-- Select Recipient --</option>
          <option value="coe@nimsuniversity.org">Controller of Examinations</option>
          <option value="tpo@nimsuniversity.org">Training and Placement Officer</option>
          <option value="directorniet@nimsuniversity.org">Director, NIET</option>
          <option value="vineet.mehan@nimsuniversity.org">HOD, Engineering Dept.</option>
          <option value="registrar@nimsuniversity.org">Registrar</option>
          <option value="all">All Recipients</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Specific Context (Optional):</label>
        <textarea name="context" placeholder="e.g., Job offer deadline, admission application deadline, specific company requirements, etc."></textarea>
      </div>
      
      <div class="btn-container">
        <button type="button" id="previewBtn" class="btn-secondary">ðŸ“‹ Preview Email</button>
        <button type="submit" class="btn-primary">ðŸ“§ Compose & Send</button>
      </div>
    </form>
    
    <div id="previewContainer" class="preview-container">
      <div class="preview-title">Email Preview:</div>
      <div id="emailPreview" class="email-preview"></div>
    </div>
  </div>

  <script>
    // Dynamic email templates for marksheet requests
    const marksheetTemplates = {
      subjects: {
        standard: [
          'Request for Marksheet Release Timeline â€“ {course} Batch {batch}',
          'Inquiry Regarding Marksheet Availability â€“ {course} {batch}',
          'Request for Academic Document Release â€“ {course} Batch {batch}',
          'Marksheet Issuance Status Inquiry â€“ {course} Final Year'
        ],
        urgent: [
          'Urgent Request for Marksheet Release Timeline â€“ {course} Batch {batch}',
          'Urgent: Marksheet Required for Employment/Admission â€“ {course} {batch}',
          'Time-Sensitive Request for Academic Documents â€“ {course} Batch {batch}',
          'Urgent Marksheet Requirement â€“ {course} Final Year Students'
        ],
        critical: [
          'Critical: Immediate Marksheet Required â€“ {course} Batch {batch}',
          'Extremely Urgent: Marksheet Needed for Deadline â€“ {course} {batch}',
          'Critical Request: Academic Documents for Immediate Processing',
          'Emergency Request for Marksheet Release â€“ {course} Batch {batch}'
        ]
      },
      
      openings: [
        'I hope this message finds you well.',
        'I hope you are doing well.',
        'I trust this email finds you in good health.',
        'I hope you are having a productive day.'
      ],
      
      introductions: [
        'I am writing to respectfully inquire about',
        'I am reaching out to request information regarding',
        'I would like to seek clarification on',
        'I am writing to request your assistance concerning'
      ],
      
      urgencyContexts: {
        standard: [
          'As we are in the process of applying for various opportunities,',
          'Since many students are preparing for their next academic or professional steps,',
          'As final year students preparing for career transitions,',
          'Given that we are approaching graduation and future planning,'
        ],
        urgent: [
          'As several students have urgent job applications and admission deadlines,',
          'Due to immediate requirements for employment verification and admissions,',
          'Given the time-sensitive nature of job offers and university applications,',
          'As we face pressing deadlines for various career opportunities,'
        ],
        critical: [
          'Due to extremely urgent deadlines for job joining and admissions,',
          'Given critical timelines that cannot be extended,',
          'As we face immediate deadlines that may affect our career prospects,',
          'Due to non-negotiable deadlines from employers and educational institutions,'
        ]
      },
      
      documentRequests: {
        final: 'final year marksheets',
        consolidated: 'consolidated academic records',
        semester: '7th semester results and marksheets for previously debarred students',
        provisional: 'provisional certificates for degree completion verification'
      },
      
      impacts: [
        'the unavailability of these documents is creating significant challenges',
        'the delay in documentation is causing considerable difficulties',
        'this documentation gap is impacting our ability to proceed',
        'the absence of these records is hindering our progress'
      ],
      
      requests: [
        'We would be sincerely grateful if you could provide clarity on',
        'We humbly request information regarding',
        'We respectfully seek guidance about',
        'We would appreciate your assistance in clarifying'
      ],
      
      timelineRequests: [
        'the expected release timeline for the required documents',
        'when we might expect these documents to be available',
        'the current status and expected completion date',
        'any tentative schedule for document release'
      ],
      
      closings: [
        'Thank you for your time and understanding. We look forward to your guidance.',
        'We appreciate your consideration of this matter and await your response.',
        'Thank you for your support in resolving this important matter.',
        'We are grateful for your attention to this request and look forward to hearing from you.'
      ]
    };
    
    // Recipient-specific customizations
    const recipientCustomizations = {
      'coe@nimsuniversity.org': {
        title: 'Controller of Examinations',
        focus: 'examination records and marksheet processing',
        specific: 'As the Controller of Examinations, your office handles the official release of academic records.',
        approach: 'We understand the importance of accuracy in academic documentation and appreciate your diligent processes.'
      },
      'tpo@nimsuniversity.org': {
        title: 'Training and Placement Officer',
        focus: 'employment opportunities and placement processes',
        specific: 'Many students are facing challenges with job applications due to documentation requirements.',
        approach: 'Your assistance in coordinating with the examination cell would greatly help students secure employment.'
      },
      'directorniet@nimsuniversity.org': {
        title: 'Director, NIET',
        focus: 'overall student welfare and institutional coordination',
        specific: 'Your leadership has always been instrumental in addressing student concerns.',
        approach: 'We request your kind intervention to expedite the documentation process.'
      },
      'vineet.mehan@nimsuniversity.org': {
        title: 'HOD, Engineering Department',
        focus: 'departmental student support and academic coordination',
        specific: 'Your mentorship has always been a pillar of support for our department students.',
        approach: 'We hope to resolve this matter under your guidance and support.'
      },
      'registrar@nimsuniversity.org': {
        title: 'Registrar',
        focus: 'academic record management and degree processes',
        specific: 'Your office oversees the official academic record management.',
        approach: 'We seek your assistance in expediting the release of required documentation.'
      }
    };
    
    function getRandomElement(array) {
      return array[Math.floor(Math.random() * array.length)];
    }
    
    function getFormData() {
      const form = document.getElementById('emailForm');
      const documents = Array.from(form.querySelectorAll('input[name="documents"]:checked'))
                           .map(cb => cb.value);
      
      return {
        name: form.name.value,
        course: form.course.value,
        rollNumber: form.rollNumber.value,
        batch: form.batch.value,
        phone: form.phone.value,
        email: form.email.value,
        documents: documents,
        urgency: form.urgency.value,
        recipient: form.recipient.value,
        context: form.context.value
      };
    }
    
    function generateDynamicEmail(formData) {
      const recipient = recipientCustomizations[formData.recipient] || 
                       { title: 'Sir/Madam', focus: 'academic matters', specific: '', approach: '' };
      
      const urgency = formData.urgency;
      const subject = getRandomElement(marksheetTemplates.subjects[urgency])
                        .replace('{course}', formData.course)
                        .replace('{batch}', formData.batch);
      
      const opening = getRandomElement(marksheetTemplates.openings);
      const introduction = getRandomElement(marksheetTemplates.introductions);
      const urgencyContext = getRandomElement(marksheetTemplates.urgencyContexts[urgency]);
      const impact = getRandomElement(marksheetTemplates.impacts);
      const request = getRandomElement(marksheetTemplates.requests);
      const timelineRequest = getRandomElement(marksheetTemplates.timelineRequests);
      const closing = getRandomElement(marksheetTemplates.closings);
      
      // Build document list
      const documentList = formData.documents.map(doc => 
        `- ${marksheetTemplates.documentRequests[doc] || doc}`
      ).join('\n');
      
      // Additional context
      const additionalContext = formData.context ? 
        `\n\nSpecific Context: ${formData.context}` : '';
      
      const body = `Dear ${recipient.title},

${opening}

${introduction} the release of marksheets for ${formData.course} students, Batch ${formData.batch}.

${urgencyContext} ${impact} in our academic and professional advancement.

We are specifically seeking:
${documentList}

${recipient.specific} ${recipient.approach}

${request}:
1. ${timelineRequest}
2. The current processing status of these documents
3. Any steps we can take to expedite the process${additionalContext}

${closing}

Yours respectfully,
${formData.name}
${formData.course}, Batch ${formData.batch}
Roll Number: ${formData.rollNumber}
Contact: ${formData.phone}
Email: ${formData.email}`;

      return { subject, body };
    }
    
    function previewEmail() {
      const formData = getFormData();
      if (!formData.name || !formData.recipient || formData.documents.length === 0) {
        alert('Please fill in your name, select a recipient, and choose at least one document type to preview.');
        return;
      }
      
      const email = generateDynamicEmail(formData);
      const preview = `Subject: ${email.subject}\n\n${email.body}`;
      
      document.getElementById('emailPreview').textContent = preview;
      document.getElementById('previewContainer').style.display = 'block';
      document.getElementById('previewContainer').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Event listeners
    document.getElementById('previewBtn').addEventListener('click', previewEmail);
    
    document.getElementById('emailForm').addEventListener('submit', function(event) {
      event.preventDefault();
      
      const formData = getFormData();
      if (formData.documents.length === 0) {
        alert('Please select at least one document type.');
        return;
      }
      
      const email = generateDynamicEmail(formData);
      
      const subject = encodeURIComponent(email.subject);
      const body = encodeURIComponent(email.body);
      
      let mailtoLink;
      if (formData.recipient === 'all') {
        const allRecipients = [
          'coe@nimsuniversity.org',
          'tpo@nimsuniversity.org',
          'directorniet@nimsuniversity.org',
          'vineet.mehan@nimsuniversity.org',
          'registrar@nimsuniversity.org'
        ].join(',');
        mailtoLink = `mailto:${allRecipients}?subject=${subject}&body=${body}`;
      } else {
        mailtoLink = `mailto:${formData.recipient}?subject=${subject}&body=${body}`;
      }
      
      window.location.href = mailtoLink;
    });
    
    // Auto-preview on key changes
    ['recipient', 'urgency'].forEach(fieldName => {
      document.querySelector(`[name="${fieldName}"]`).addEventListener('change', function() {
        const nameField = document.querySelector('input[name="name"]');
        const documentsChecked = document.querySelectorAll('input[name="documents"]:checked');
        if (nameField.value && this.value && documentsChecked.length > 0) {
          setTimeout(previewEmail, 100);
        }
      });
    });
    
    // Auto-preview on document selection change
    document.querySelectorAll('input[name="documents"]').forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        const nameField = document.querySelector('input[name="name"]');
        const recipientField = document.querySelector('[name="recipient"]');
        const documentsChecked = document.querySelectorAll('input[name="documents"]:checked');
        if (nameField.value && recipientField.value && documentsChecked.length > 0) {
          setTimeout(previewEmail, 100);
        }
      });
    });
  </script>
</body>
</html>